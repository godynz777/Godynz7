local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

-- Criar Interface
local ScreenGui = Instance.new("ScreenGui", game.CoreGui)
ScreenGui.Name = "ESP_UI"

-- Janela da interface
local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 170, 0, 60)
Frame.Position = UDim2.new(0, 20, 0, 100)
Frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20) -- preto
Frame.BorderSizePixel = 0
Frame.Active = true
Frame.Draggable = true
Frame.Parent = ScreenGui

-- Título
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0.4, 0)
Title.BackgroundTransparency = 1
Title.Text = "ESP MENU"
Title.TextColor3 = Color3.fromRGB(170, 0, 255)
Title.Font = Enum.Font.GothamBold
Title.TextScaled = true
Title.Parent = Frame

-- Botão
local ToggleButton = Instance.new("TextButton")
ToggleButton.Size = UDim2.new(0.9, 0, 0.4, 0)
ToggleButton.Position = UDim2.new(0.05, 0, 0.5, 0)
ToggleButton.BackgroundColor3 = Color3.fromRGB(128, 0, 255) -- roxo
ToggleButton.BorderSizePixel = 0
ToggleButton.Text = "ESP: ON"
ToggleButton.TextColor3 = Color3.new(1, 1, 1)
ToggleButton.Font = Enum.Font.Gotham
ToggleButton.TextScaled = true
ToggleButton.Parent = Frame

-- Lógica do ESP
local espEnabled = true
ToggleButton.MouseButton1Click:Connect(function()
    espEnabled = not espEnabled
    ToggleButton.Text = "ESP: " .. (espEnabled and "ON" or "OFF")
end)

-- Criar Highlight roxo
local function addESP(player)
    if player == LocalPlayer then return end
    if player.Team == LocalPlayer.Team then return end
    if not player.Character or player.Character:FindFirstChildOfClass("Highlight") then return end

    local esp = Instance.new("Highlight")
    esp.Name = "ESP_Highlight"
    esp.FillColor = Color3.fromRGB(170, 0, 255)
    esp.FillTransparency = 0.6
    esp.OutlineColor = Color3.fromRGB(255, 255, 255)
    esp.OutlineTransparency = 0.1
    esp.Adornee = player.Character
    esp.Parent = player.Character
end

local function removeESP(player)
    if player.Character and player.Character:FindFirstChild("ESP_Highlight") then
        player.Character.ESP_Highlight:Destroy()
    end
end

-- Loop ESP
RunService.RenderStepped:Connect(function()
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            if espEnabled then
                addESP(player)
            else
                removeESP(player)
            end
        end
    end
end)
